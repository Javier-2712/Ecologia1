---
title: "Modelos logisticos de poblaciones"
lang: "es-ES"
format:
  docx:
    toc: true
    toc-title: Contents
    toc-depth: 3
    toc-location: left
    html-math-method: katex
    link-external-icon: true
    link-external-newwindow: true
    theme: flatly
    fontsize: 1.1em
    linestretch: 1.5    

---

<b style='color:#1f78b4;'>

## Objetivo de la actividad

</b>

Entrenamiento de procedimientos básicos para el análisis de modelos
logísticos en poblaciones silvestres, con la aplicación del programa
RStudio.

### <b style='color:#d95f02;'> Modelos de crecimiento logístico </b>

1.  Una población de pasálidos crece de acuerdo a la ecuación logística.
    Si la población inicial es de 200 individuos, la capacidad de carga
    es de 500 pasálidos y la tasa de crecimiento es de 0.1
    pasálidos/pasálidos x mes, a) ¿cuál es la tasa de crecimiento para
    la población dN/dt? b) ¿cuál es la tasa máxima de crecimiento para
    la población dN/dt máx? c) ¿cuál es la tasa de crecimiento para la
    población dN/dt si se cuenta con 600 individuos? d) Cuál será la
    densidad de la población en cinco meses, si se inicia con 200
    individuos? e) Cuál es el tiempo requerido para alcanzar 400
    individuos, partiendo de 200 iniciales?

![Adulto *Odontotaenius disjunctus* (tomado de Wikipedia
[enlace](https://es.wikipedia.org/wiki/Passalidae))](https://upload.wikimedia.org/wikipedia/commons/thumb/9/96/Beetle-Bessbug.jpg/800px-Beetle-Bessbug.jpg){width="338"}

## 

2.  Una población de bacterias crece de acuerdo a la ecuación logística.
    Si la población inicial es de 500 bacterias y la capacidad de carga
    es de 10000 bacterias, y la tasa de crecimiento es de 0.05
    bacterias/bacteria x hora, ¿cuál es la tasa de crecimiento para la
    población dN/dt?

### <b style='color:#d95f02;'> Respuestas </b>

**Pregunta 1**

**a) Datos** No = 200 individuos k = 500 individuos r = 0.1 indv./indv.
x mes dN/dt = ?

**Paso 1:** Datos para la ecuación logística

```{r}
# Cálculo de la tasa o velocidad de crecimiento de la población de pasálidos
No = 200 
k  = 500 
r  = 0.1 
dN_dt = r * No * (1 - (No/k))
dN_dt      # Por cada més la población aumenta en 12 individuos
```

**Paso 2** Base de datos

```{r}
#
t = seq(0,100, by=5)
t

Nt = k/(1 + ((k-No)/No) * exp(-r*t))
round(Nt)

datos = data.frame(tiempo = t, densidad = round(Nt))
datos
```

**Paso 3:** Figura de la proyección logística de la población.


La @fig-fig1, muestra que la población de pasálido alcanza su capacidad de carga de 500 individuos en a los 75 meses.

```{r}
#| label: fig-fig1
#| fig-cap: Poyección logística de la población de pasálido, iniciando con 200 individuos (No), hasta alcanzar su capacidad de carga de 500 individuos (K).
# 
library(ggplot2)
t = 75

ggplot(datos, aes(x= tiempo, y= densidad)) +   # Capa de ejes 
  
  # Capas de líneas del modelo
  geom_line(color="blue") +
  geom_point(color="red", size=2) +
  geom_vline(xintercept = t, color = "black", linetype = "dashed") +   # Línea de t (75) para N = k
  geom_hline(yintercept = k, color ="black", linetype = "dashed")   +   # Línea de k (500) 
  
  # Capas de texto en la figura
  geom_text(x = t + 0.5, y = 470, 
            label = paste("Valor de k\nen", t, "meses"),
            color = "blue", size = 4, vjust = 0.5) +
  geom_point(aes(x = t, y = k), color = "blue", size = 4) +
  
  # Capas de rotulos de los ejes
  labs(x= "t (Meses)", y ="Poblacion (Nt)",
       title= "Proyeccion logistica de la poblacion de Pasalidos") +
  theme_classic()
```

**b) Datos** No = 200 individuos k = 500 individuos r = 0.1 indv./indv.
x mes `dN/dt max = ?` Máxima capacidad o velocidad de aumento de la
población

**Paso 1:** Datos para la ecuación logística

La velocidad de crecimiento k/2 fue de 12 individuos por mes y la velocidad o tasa máxima de aumento de la población es de 12.5 individuos por mes cuando se cuenta con un k/2 de 250 individuos (K=500 individuos)

```{r}
#
No = 200 
k  = 500 
r  = 0.1 
k_2 = 500/2

dN_dt.max = r * k_2 * (1-(k_2/k))
dN_dt.max     # La veloidad máxima de aumento de la población es de 12.5 indv. / t

```

**Paso 2** Base de datos de Nt vs. dN_dt

```{r}
# 
No= 1
t = seq(0,150, by=10)   # Secuencia de tiempos de 0 a 150 meses
t

Nt = k/(1 + ((k-No)/No) * exp(-r*t))   # Cálculo de Nt para los diferentes tiempos (meses)
round(Nt)

dN_dt = r * Nt * (1 - (Nt/k))   # Cálculo de tasa dN_dt para los diferentes Nt
dN_dt

datos = data.frame(densidad_Nt = round(Nt), dN_dt = round(dN_dt))
datos
```

**Paso 3:** Figura de la proyección logística de la población.

La @fig-fig2 muestra la relación de la velocidad de aumento `(dN/dt) con el tamaño de la población (Nt)`, definiendo que la máxima tasa de aumento `(dN/dt máx. = 12.5 indv. x meés)` se presenta en un k/2 de 250 pasalidos. Este pstrón puede ser visualizado en la pendiente de la curva de la @fig-fig1.


```{r, message=FALSE}
#| label: fig-fig2
#| fig-cap: Patrón unimodal en la relación de la velocidad de aumento (dN/dt) con el tamaño de la población (Nt)
#
library(ggplot2)

Nt = 250

# Capas de de los ejes de la figura
ggplot(datos, aes(x= densidad_Nt, y= dN_dt)) +
  geom_smooth(color="blue") +
  geom_point(color="red", size=2) +
  geom_vline(xintercept = 250, color = "black", linetype = "dashed") +     # Línea de t (75) para N = k
  geom_hline(yintercept = 12.5, color ="black", linetype = "dashed")   +   # Línea de k (500) 
  
  # Capas de texto en la figura
  geom_text(x = 250, y = 11, 
            label = paste("Valor de dN/dt.max\nen Nt = 250 indv."),
            color = "blue", size = 4, vjust = 0.5) +
  geom_point(aes(x = 250, y = 12.5), color = "blue", size = 4) +

     
  #
  labs(x= "Densidad (Nt)", y ="Tasa de Crecimiento (dN/dt)",
       title= "Proyeccion logistica de la poblacion de Pasalidos") +
  theme_classic()
```

##
c) ¿cuál es la tasa de crecimiento para la población dN/dt si se cuenta con 600 individuos? 

Datos de el ejercicio:

No = 600 individuos
k  = 500 individuos
r  = 0.1 indv./indv. x mes
dN_dt = ?


**Paso 1.** Datos para la ecuación logística

Si la población incia con 600 individuos, está supera a su capacidad de carga en 100 individuos, presentando una tasa o velocidad de disminución de 12 individuos por mes. 

```{r}
#
No = 600 
k  = 500 
r  = 0.1 
dN_dt = r * No * (1-(No/k))
dN_dt

```
**Paso 2.** Base de datos  

```{r}
#
t = seq(0,100, by= 5)
t
Nt = k/(1+((k-No)/No)*exp(-r*t))
round(Nt)
# Base de datos (datos)
datos = data.frame(tiempo=t, densidad=round(Nt))
head(datos)   # head muestra solo las 6 primeras filas de la tabla.
```

Paso 3. Figura de la proyección logística

La @fig-fig3 permite visualizar el descenso de la población, debido a que la densidad inicial se encuentra por encima de su capacidad de carga.

```{r, message=FALSE, warning=FALSE}
#| label: fig-fig3
#| fig-cap: Poyección de siminución de la población hasta alcanzar su capacidad de carga en 55 meses.
#
library(ggplot2)
t = 55           # Tiempo en que la pob. desciende a su valor de k (500 indv.)

#
ggplot(datos, aes(x= tiempo, y=densidad)) +
  
  geom_line(color="blue", size=1.2) +
  geom_point(color="red", size= 3)  +
  
  geom_hline(yintercept = k, color = "black", linetype = "dashed") +
  geom_vline(xintercept = t, color = "black", linetype = "dashed") +
  
  labs(x= "t (meses)", y= "Población (Nt)",
       title = "Proyección logística de la población")  +
  
  theme_minimal()

```
##
d) Cuál será la densidad de la población en cinco meses, si se inicia con 200 individuos? 

Datos del ejercicio

No = 200 individuos
k  = 500 individuos
r  = 0.1 indv./indv. x mes
t  = 5 meses
N5 = ?

**Paso 1.** Datos para la ecuación logística

```{r}
No = 200 
k  = 500 
r  = 0.1 
t  = 5 

N5 = k / (1+((k-No)/No) * exp(-r*t))
round(N5)
```

##
e) Cuál es el tiempo requerido para alcanzar 400 individuos, partiendo de 200 iniciales?

Datos del ejercicio

No = 200 individuos
Nt = 400 individuos
k  = 500 individuos
r  = 0.1 indv./indv. x mes
t  = ?

**Paso 1.** Datos para la ecuación logística

```{r}
No = 200 
Nt = 400 
k  = 500 
r  = 0.1 

t = (log(Nt) - log(k) + log(1+((k-No)/No)))/r
t

# Prueba debe dar Nt = 500
Nt = k / (1+((k-No)/No) * exp(-r*6.931472))
round(Nt)
  
```









